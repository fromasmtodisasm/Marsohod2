/*
 * Дизассемблер
 */
 
// Список мнемоник, используюстя в ops
const char* mnemonics[] = {
  
    /* 00 */ "ADD",     /* 01 */ "OR",      /* 02 */ "ADC",     /* 03 */ "SBB",
    /* 04 */ "AND",     /* 05 */ "SUB",     /* 06 */ "XOR",     /* 07 */ "CMP",
    /* 08 */ "ES:",     /* 09 */ "CS:",     /* 0A */ "SS:",     /* 0B */ "DS:",
    /* 0C */ "FS:",     /* 0D */ "GS:",     /* 0E */ "PUSH",    /* 0F */ "POP",

    /* 10 */ "DAA",     /* 11 */ "DAS",     /* 12 */ "AAA",     /* 13 */ "AAS",
    /* 14 */ "INC",     /* 15 */ "DEC",     /* 16 */ "PUSHA",   /* 17 */ "POPA",
    /* 18 */ "BOUND",   /* 19 */ "ARPL",    /* 1A */ "IMUL",    /* 1B */ "INS",
    /* 1C */ "OUTS",    /* 1D */ "TEST",    /* 1E */ "XCHG",    /* 1F */ "LEA",

    /* 20 */ "JO",      /* 21 */ "JNO",     /* 22 */ "JB",      /* 23 */ "JNB",
    /* 24 */ "JZ",      /* 25 */ "JNZ",     /* 26 */ "JBE",     /* 27 */ "JNBE",
    /* 28 */ "JS",      /* 29 */ "JNS",     /* 2A */ "JP",      /* 2B */ "JNP",
    /* 2C */ "JL",      /* 2D */ "JNL",     /* 2E */ "JLE",     /* 2F */ "JNLE"    
    
    /* 30 */ "MOV",     /* 31 */ "NOP",     /* 32 */ "CBW",     /* 33 */ "CWD",    
    /* 34 */ "CWDE",    /* 35 */ "CDQ",     /* 36 */ "CALLF",   /* 37 */ "FWAIT",
    /* 38 */ "PUSHF",   /* 39 */ "POPF",    /* 3A */ "SAHF",    /* 3B */ "LAHF",
    /* 3C */ "MOVS",    /* 3D */ "CMPS",    /* 3E */ "STOS",    /* 3F */ "LODS",
    
    /* 40 */ "SCAS",    /* 41 */ "RET",     /* 42 */ "RETF",    /* 43 */ "LES",
    /* 44 */ "LDS",     /* 45 */ "LFS",     /* 46 */ "LGS",     /* 47 */ "ENTER",
    /* 48 */ "LEAVE",   /* 49 */ "INT",     /* 4A */ "INT1",    /* 4B */ "INT3",
    /* 4C */ "INTO",    /* 4D */ "IRET",    /* 4E */ "AAM",     /* 4F */ "AAD",
    
    /* 50 */ "SALC",    /* 51 */ "XLATB",   /* 52 */ "LOOPNZ",  /* 53 */ "LOOPZ",
    /* 54 */ "LOOP",    /* 55 */ "JCXZ",    /* 56 */ "IN",      /* 57 */ "OUT",
    /* 58 */ "CALL",    /* 59 */ "JMP",     /* 5A */ "JMPF",    /* 5B */ "LOCK:",
    /* 5C */ "REPNZ:",  /* 5D */ "REPZ:",   /* 5E */ "HLT",     /* 5F */ "CMC",
    
    /* 60 */ "CLC",     /* 61 */ "STC",     /* 62 */ "CLI",     /* 63 */ "STI",
    /* 64 */ "CLD",     /* 65 */ "STD",     /* 66 */ "ROL",     /* 67 */ "ROR",
    /* 68 */ "RCL",     /* 69 */ "RCR",     /* 6A */ "SHL",     /* 6B */ "SHR",
    /* 6C */ "SAL",     /* 6D */ "SAR",     /* 6E */ "NOT",     /* 6F */ "NEG",
    
    /* 70 */ "MUL",     /* 71 */ "DIV",     /* 72 */ "IDIV",    /* 73 */ "REP:",        
    /* 74 */ "",        /* 75 */ "",        /* 76 */ "",        /* 77 */ "",
    /* 78 */ "",        /* 79 */ "",        /* 7A */ "",        /* 7B */ "",
    /* 7C */ "",        /* 7D */ "",        /* 7E */ "",        /* 7F */ "",    
};
 
const int ops[512] = {
    
    /* Основной набор */
    /* 00 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x0F,
    /* 08 */ 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x0E, 0xFF,
    /* 10 */ 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x0E, 0x0F,
    /* 18 */ 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x0E, 0x0F,
    /* 20 */ 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x08, 0x10,
    /* 28 */ 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x09, 0x11,
    /* 30 */ 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x0A, 0x12,
    /* 38 */ 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x0B, 0x13,    
    /* 40 */ 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14,
    /* 48 */ 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15,
    /* 50 */ 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E,
    /* 58 */ 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
    /* 60 */ 0x16, 0x17, 0x18, 0x19, 0x0C, 0x0D, 0xFF, 0xFF,
    /* 68 */ 0x0E, 0x1A, 0x0E, 0x1A, 0x1B, 0x1B, 0x1C, 0x1C,    
    /* 70 */ 0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27,
    /* 78 */ 0x28, 0x29, 0x2A, 0x2B, 0x2C, 0x2D, 0x2E, 0x2F,
    /* 80 */ 0xFF, 0xFF, 0xFF, 0xFF, 0x1D, 0x1D, 0x1E, 0x1E,
    /* 88 */ 0x30, 0x30, 0x30, 0x30, 0x30, 0x1F, 0x30, 0x0F,
    /* 90 */ 0x31, 0x1E, 0x1E, 0x1E, 0x1E, 0x1E, 0x1E, 0x1E,    
    /* 98 */ 0x32, 0x33, 0x36, 0x37, 0x38, 0x39, 0x3A, 0x3B,    
    /* A0 */ 0x30, 0x30, 0x30, 0x30, 0x3C, 0x3C, 0x3D, 0x3D,
    /* A8 */ 0x1D, 0x1D, 0x3E, 0x3E, 0x3F, 0x3F, 0x40, 0x40,
    /* B0 */ 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
    /* B8 */ 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
    /* C0 */ 0xFF, 0xFF, 0x41, 0x41, 0x43, 0x44, 0x30, 0x30,
    /* C8 */ 0x47, 0x48, 0x42, 0x42, 0x4B, 0x49, 0x4C, 0x4D,
    /* D0 */ 0xFF, 0xFF, 0xFF, 0xFF, 0x4E, 0x4F, 0x50, 0x51,
    /* D8 */ 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
    /* E0 */ 0x52, 0x53, 0x54, 0x55, 0x56, 0x56, 0x57, 0x57,
    /* E8 */ 0x58, 0x59, 0x5A, 0x59, 0x56, 0x56, 0x57, 0x57,
    /* F0 */ 0x5B, 0x4A, 0x5C, 0x5D, 0x5E, 0x5F, 0xFF, 0xFF,
    /* F8 */ 0x60, 0x61, 0x62, 0x63, 0x64, 0x65, 0xFF, 0xFF,
    
    /* Дополнительный набор */
    /* 00 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 08 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 10 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 18 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 20 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 28 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 30 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 38 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 40 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 48 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 50 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 58 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 60 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 68 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 70 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 78 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 80 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 88 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 90 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* 98 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* A0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* A8 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* B0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* B8 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* C0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* C8 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* D0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* D8 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* E0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* E8 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* F0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    /* F8 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    
};

unsigned char disas_row[256];

/* Дизассемблирование одной инструкции */
unsigned char* disas(Uint32 address) {
        
    sprintf(disas_row, "%s", mnemonics[0]);
    
    return disas_row;
} 
