void redraw_textmode();

/* cpu.c */
Uint32 eflags, pflags;      /* pflags для отладчика */

Uint32 eax, esp;
Uint32 ecx, ebp;
Uint32 ebx, esi;
Uint32 edx, edi;
Uint32 eip;

Uint16 es, cs, ds, ss, fs, gs;
Uint8  processor_mode;      /* 0 - realmode, 1 - protected mode */
Uint8  default_reg;

const Uint8 modrm_lookup[512] = {
    
    /*       0 1 2 3 4 5 6 7 8 9 A B C D E F */
    /* 00 */ 1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
    /* 10 */ 1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
    /* 20 */ 1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
    /* 30 */ 1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
    /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 60 */ 0,0,1,1,0,0,0,0,0,1,0,1,0,0,0,0,
    /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 80 */ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
    /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* A0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* B0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* C0 */ 1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,
    /* D0 */ 1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,
    /* E0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* F0 */ 0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,
    
    // Ext -- todo
    /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* A0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* B0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* C0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* D0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* E0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    /* F0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
        
};
